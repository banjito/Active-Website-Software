CREATE OR REPLACE FUNCTION create_migrations_table_if_not_exists() RETURNS void LANGUAGE plpgsql SECURITY DEFINER AS CREATE OR REPLACE FUNCTION exec_sql(sql_query TEXT) RETURNS void LANGUAGE plpgsql SECURITY DEFINER AS $$ BEGIN EXECUTE sql_query; END; $$; BEGIN CREATE TABLE IF NOT EXISTS migrations (id SERIAL PRIMARY KEY, name TEXT NOT NULL UNIQUE, applied_at TIMESTAMPTZ DEFAULT NOW()); END; CREATE OR REPLACE FUNCTION exec_sql(sql_query TEXT) RETURNS void LANGUAGE plpgsql SECURITY DEFINER AS $$ BEGIN EXECUTE sql_query; END; $$;;
